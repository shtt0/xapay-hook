# XAPay Hooks

XAPay Hooks は、Xahau ネットワーク上で動作するカスタムフックです。1 XAH = 1 円のステーブルコインとして機能し、以下の機能を提供します：

1. チャージ機能

   - ユーザーアカウントへの XAH トークンのチャージ（1 XAH = 1 円）
   - 残高の管理とオーバーフロー防止
   - 最大チャージ額の制限（1,000,000 XAH = 1,000,000 円）

2. 出金機能

   - 店舗 ID（01-99）による出金処理
   - 署名検証による認証
   - 残高チェック

3. セキュリティ機能
   - オペレーターアカウントによる操作制限
   - 署名検証による認証
   - XAH 通貨のみのサポート

## 使用方法

1. チャージ

   - Payment トランザクションで XAH を送信（1 XAH = 1 円）
   - メモに `r[amount]` 形式でチャージ情報を指定

2. 出金
   - Invoke トランザクションで出金処理を実行
   - メモに `w[shop_id]` 形式で出金情報を指定（shop_id は 01-99）

## 制限事項

- 最大チャージ額: 1,000,000 XAH（1,000,000 円相当）
- 店舗 ID: 01-99 の 2 桁数字
- サポート通貨: XAH のみ（1 XAH = 1 円のステーブルコイン）
- 操作権限: オペレーターアカウントまたはアカウント所有者のみ

## エラーコード

- 340: 無効な金額形式
- 304: 残高不足
- 350: 状態更新エラー
- 351: 無効なメモ形式
- 352: 無効な出金形式
- 355: 残高オーバーフロー
- 357: 無効な通貨
- 358: 無効な店舗 ID
- 359: 無効な署名

## コンパイルとデプロイ

1. Hooks Builder で`xapay.c`をコンパイル
2. コンパイルされたフックを Xahau ネットワークにデプロイ

## 注意事項

- このフックは標準ライブラリへの依存を完全に排除しています
- メモリ操作はすべてマクロ定義を使用して実装されています
- セキュリティのため、すべての操作は署名検証を必要とします
- オペレーターアカウントの設定が必要です
- XAH は 1 XAH = 1 円のステーブルコインとして実装されています
